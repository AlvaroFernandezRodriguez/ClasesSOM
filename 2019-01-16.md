# Clase de hoy
https://jesusninoc.github.io/ClasesSOM/2019-01-16.html

# Tareas de administración I
- Agregar/Eliminar software
- Actualización
- Gestión de procesos
- Programación de tareas

--------------

# Gestión de procesos
```PowerShell
# Muestra los módulos de todos los procesos
Get-Process -Module

# Muestra los módulos de Notepad
Get-Process -Name notepad -Module

# Mostrar los procesos que se están ejecutando en relación con los servicios (solo llamadas WMI)
(Get-WmiObject -Class Win32_Service | Where-Object State -EQ 'Running') | %{
Write-Host $_.Name,$_.ProcessId,$_.State,(Get-WmiObject -Class win32_process | Where-Object ProcessId -EQ  $_.ProcessId).ProcessId
}

# Mostrar los procesos que tengan por primera letra del nombre w
Get-Process -Name w*

# Quitar el encabezado
(Get-Process | select ProcessName).ProcessName

# Mostrar los procesos que se están ejecutando, junto con los ficheros que se están ejecutando en cada proceso. La lista de procesos tiene que salir en formato lista
Get-Process | select Name,Modules | Format-List

# Terminar un proceso indicando el identificador
Start-Process notepad
(Get-Process notepad).id
Stop-Process -id (Get-Process notepad).id
```

# Programación de tareas
## PowerShell
- https://github.com/jesusninoc/PowerShell/blob/master/TareasProgramadas/EjemploTareaProgramada.ps1
## Linux
- https://github.com/jesusninoc/Bash/blob/master/TareasProgramadas/EjerciciosTareasProgramadas.sh
- https://github.com/jesusninoc/Bash/blob/master/Examenes/Examen-2016-02-11-Solucion.sh

# Reading RunOnce Key
http://community.idera.com/powershell/powertips/b/tips/posts/reading-runonce-key

# Ejecutar solo una vez un programa al iniciar la sesión de un usuario
https://www.jesusninoc.com/2017/04/13/ejecutar-solo-una-vez-un-programa-al-iniciar-la-sesion-de-un-usuario/

# Eventos

## Mostrar un mensaje en PowerShell cuando se ejecuta un programa
https://www.jesusninoc.com/2017/09/04/mostrar-un-mensaje-en-powershell-cuando-se-ejecuta-un-programa/

## Registrar un evento y mostrar un mensaje en PowerShell cuando se ejecuta un programa
https://www.jesusninoc.com/2017/09/29/registrar-un-evento-y-mostrar-un-mensaje-en-powershell-cuando-se-ejecuta-un-programa/

## Registrar un evento y mostrar un mensaje en PowerShell cuando se ejecutan varios programas
https://www.jesusninoc.com/2017/10/29/registrar-un-evento-y-mostrar-un-mensaje-en-powershell-cuando-se-ejecutan-varios-programas/

## Realizar un volcado de memoria de un proceso cuando se empieza a ejecutar
https://www.jesusninoc.com/2017/09/14/realizar-un-volcado-de-memoria-de-un-proceso-cuando-se-empieza-a-ejecutar/
